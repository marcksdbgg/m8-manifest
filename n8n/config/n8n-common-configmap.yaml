# n8n/config/n8n-common-configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: n8n-common-config
  namespace: n8n-tenants
data:
  # Configuraci칩n crucial para que n8n escuche en todas las interfaces dentro del pod
  N8N_LISTEN_ADDRESS: "0.0.0.0"
  # Zona horaria para ejecuciones programadas
  TZ: "America/Lima"
  # Tipo de base de datos a usar
  DB_TYPE: "postgresdb"
  # Desactivar SSL para conexiones internas con la base Postgres del cluster
  # Si necesita usar SSL (recomendado para conexiones externas), configure
  # certificados y habilite SSL en el pod de postgres, adem치s de configurar
  # las variables apropiadas en n8n (DB_POSTGRESDB_SSL=true y certificados CA).
  DB_POSTGRESDB_SSL: "false"
  # Puerto por defecto de Postgres en el cluster (opcional)
  DB_POSTGRESDB_PORT: "5432"
  # Modo de ejecuci칩n para usar workers
  EXECUTIONS_MODE: "queue"
  # Confiar en Traefik y las redes internas para X-Forwarded-For
  N8N_SECURITY_TRUSTED_PROXIES: "loopback,linklocal,uniquelocal,10.42.0.0/16,10.43.0.0/16"
  # Aplicar permisos estrictos al archivo de settings
  N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS: "true"
  # Adoptar task runners y offload de ejecuciones manuales
  N8N_RUNNERS_ENABLED: "true"
  OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS: "true"
  # Mantener acceso a variables de entorno en nodos de c칩digo (valor actual)
  N8N_BLOCK_ENV_ACCESS_IN_NODE: "false"
  # Deshabilitar repositorios bare en el nodo Git
  N8N_GIT_NODE_DISABLE_BARE_REPOS: "true"